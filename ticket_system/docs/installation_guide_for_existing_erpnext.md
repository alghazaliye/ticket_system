# دليل تثبيت نظام حجز التذاكر على نظام ERPNext موجود

هذا الدليل يشرح كيفية تثبيت وإعداد نظام حجز التذاكر على منصة ERPNext موجودة بالفعل.

## المتطلبات الأساسية

قبل البدء في عملية التثبيت، تأكد من توفر المتطلبات التالية:

1. تثبيت ERPNext الإصدار 13 أو أحدث
2. صلاحيات مدير النظام في ERPNext
3. Python 3.7 أو أحدث
4. Node.js 14 أو أحدث
5. Git

## خطوات التثبيت

### 1. تنزيل التطبيق

قم بتنزيل التطبيق من مستودع Git أو نسخ ملفات التطبيق إلى مجلد التطبيقات في ERPNext:

```bash
cd /path/to/frappe-bench
bench get-app ticket_system https://github.com/your-organization/ticket_system.git
```

أو إذا كان لديك ملفات التطبيق محلياً:

```bash
cd /path/to/frappe-bench
mkdir -p apps/ticket_system
cp -r /path/to/ticket_system_app/* apps/ticket_system/
```

### 2. تثبيت التطبيق

قم بتثبيت التطبيق على موقع ERPNext الخاص بك:

```bash
cd /path/to/frappe-bench
bench --site your-site.local install-app ticket_system
```

### 3. تحديث النظام

قم بتحديث النظام لتطبيق التغييرات:

```bash
cd /path/to/frappe-bench
bench --site your-site.local migrate
bench build
bench restart
```

### 4. إنشاء قاعدة البيانات

بعد تثبيت التطبيق، ستحتاج إلى إنشاء أنواع المستندات (Doctypes) الأساسية وإعداد البيانات الأولية:

1. قم بتسجيل الدخول إلى ERPNext كمدير نظام
2. انتقل إلى "إضافة بيانات" > "البيانات الأولية" > "نظام حجز التذاكر"
3. انقر على زر "إنشاء البيانات الأولية" لإنشاء البيانات الأساسية

أو يمكنك تنفيذ سكريبت إعداد البيانات الأولية من خلال سطر الأوامر:

```bash
cd /path/to/frappe-bench
bench --site your-site.local execute ticket_system.setup.install.after_install
```

### 5. تكوين النظام

#### 5.1 إعدادات النظام

انتقل إلى "إعدادات نظام حجز التذاكر" لتكوين الإعدادات الأساسية للنظام:

1. انتقل إلى "نظام حجز التذاكر" > "الإعدادات" > "إعدادات نظام حجز التذاكر"
2. قم بتعبئة الحقول المطلوبة:
   - اسم الشركة
   - شعار الشركة
   - عنوان الشركة
   - رقم الهاتف
   - البريد الإلكتروني
   - العملة الافتراضية
   - نسبة العمولة الافتراضية للوكلاء
   - إعدادات الضرائب (إن وجدت)

#### 5.2 إعداد المستخدمين والأذونات

قم بإنشاء المستخدمين وتعيين الأدوار المناسبة:

1. انتقل إلى "المستخدمون والأذونات" > "المستخدم"
2. قم بإنشاء مستخدمين جدد أو تعديل المستخدمين الحاليين
3. قم بتعيين الأدوار المناسبة لكل مستخدم:
   - مدير نظام حجز التذاكر
   - موظف حجز
   - مدير وكلاء
   - مدير تقارير

#### 5.3 إعداد البيانات الأساسية

قم بإدخال البيانات الأساسية للنظام:

1. **المدن**:
   - انتقل إلى "نظام حجز التذاكر" > "البيانات الأساسية" > "المدن"
   - قم بإضافة المدن التي ستتعامل معها

2. **المسارات**:
   - انتقل إلى "نظام حجز التذاكر" > "البيانات الأساسية" > "المسارات"
   - قم بإنشاء المسارات بين المدن مع تحديد المدينة المصدر والوجهة والمسافة

3. **المركبات**:
   - انتقل إلى "نظام حجز التذاكر" > "البيانات الأساسية" > "المركبات"
   - قم بإضافة المركبات مع تحديد النوع ورقم المركبة وعدد المقاعد

4. **المقاعد**:
   - بعد إضافة المركبات، انتقل إلى صفحة تفاصيل المركبة
   - انقر على زر "إنشاء المقاعد" لإنشاء المقاعد تلقائياً بناءً على عدد المقاعد المحدد

5. **الوكلاء**:
   - انتقل إلى "نظام حجز التذاكر" > "الوكلاء" > "الوكيل"
   - قم بإضافة الوكلاء مع تحديد البيانات المطلوبة ونسبة العمولة

### 6. إنشاء الرحلات

بعد إعداد البيانات الأساسية، يمكنك البدء في إنشاء الرحلات:

1. انتقل إلى "نظام حجز التذاكر" > "الرحلات" > "الرحلة"
2. قم بإنشاء رحلات جديدة مع تحديد المسار والتاريخ ووقت المغادرة والوصول والمركبة والسعر

### 7. اختبار النظام

بعد إكمال الإعداد، قم باختبار النظام للتأكد من عمله بشكل صحيح:

1. انتقل إلى "نظام حجز التذاكر" > "البحث عن الرحلات"
2. قم بالبحث عن رحلة متاحة
3. قم بإنشاء حجز جديد
4. تحقق من إنشاء التذاكر بنجاح
5. اختبر طباعة التذاكر
6. اختبر إنشاء التقارير المختلفة

## التكامل مع نظام ERPNext الموجود

### 1. التكامل مع وحدة الحسابات

يمكن تكوين نظام حجز التذاكر للتكامل مع وحدة الحسابات في ERPNext:

1. انتقل إلى "نظام حجز التذاكر" > "الإعدادات" > "إعدادات التكامل"
2. قم بتمكين خيار "التكامل مع الحسابات"
3. حدد الحسابات المناسبة لكل نوع من المعاملات:
   - حساب إيرادات التذاكر
   - حساب عمولات الوكلاء
   - حساب المستحقات من الوكلاء
   - حساب المستحقات للوكلاء

### 2. التكامل مع وحدة العملاء

يمكن تكوين نظام حجز التذاكر لاستخدام بيانات العملاء الموجودة في ERPNext:

1. انتقل إلى "نظام حجز التذاكر" > "الإعدادات" > "إعدادات التكامل"
2. قم بتمكين خيار "استخدام بيانات العملاء من ERPNext"
3. حدد الحقول التي ترغب في مزامنتها بين نظام العملاء في ERPNext ونظام حجز التذاكر

### 3. التكامل مع وحدة المدفوعات

يمكن تكوين نظام حجز التذاكر للتكامل مع وحدة المدفوعات في ERPNext:

1. انتقل إلى "نظام حجز التذاكر" > "الإعدادات" > "إعدادات التكامل"
2. قم بتمكين خيار "التكامل مع المدفوعات"
3. حدد طرق الدفع المتاحة وإعداداتها

## استكشاف الأخطاء وإصلاحها

### مشاكل التكامل مع ERPNext

إذا واجهت مشاكل في التكامل مع نظام ERPNext الموجود:

1. تأكد من تحديث نظام ERPNext إلى الإصدار المدعوم
2. تحقق من صلاحيات المستخدم وتأكد من أنها تشمل الوصول إلى الوحدات المطلوبة
3. راجع سجلات الأخطاء في `/path/to/frappe-bench/logs/frappe.log`
4. تأكد من تكوين إعدادات التكامل بشكل صحيح

### مشاكل الأداء

إذا واجهت مشاكل في أداء النظام:

1. تأكد من تكوين قاعدة البيانات بشكل صحيح
2. قم بتحسين أداء قاعدة البيانات عن طريق إضافة فهارس للحقول المستخدمة بكثرة في عمليات البحث
3. قم بتكوين التخزين المؤقت (caching) لتحسين أداء النظام

## الدعم الفني

إذا كنت بحاجة إلى مساعدة إضافية، يمكنك التواصل مع فريق الدعم الفني:

- البريد الإلكتروني: support@example.com
- رقم الهاتف: +123456789
- موقع الدعم الفني: https://support.example.com
